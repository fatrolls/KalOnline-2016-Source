#include "OnSend.h"
#include "Interface.h"
#include "Hooks.h"
#include "Tools.h"

CREATE_INTERFACE(IOnSend)

unsigned long IOnSend::Patches[] =
{
	0x0040225F,0x0040231B,0x004105B3,0x00410BAF,0x00410BE5,0x00410CB2,0x00410CE4,0x00411514,0x00411593,0x00411661,
	0x004116E2,0x004117C3,0x00412CC7,0x00412ECB,0x0041326F,0x004141DD,0x0041458D,0x0041483B,0x00414BFA,0x00414C2F,
	0x00414CAF,0x00414DFD,0x00414F09,0x004152C7,0x00415334,0x0041549B,0x00415557,0x0041556A,0x00415589,0x0041559F,
	0x0041681A,0x00416A28,0x00416C4B,0x004A6766,0x0050A4E1,0x0050DECE,0x0050DEF2,0x0050DF16,0x0050DF3A,0x0050DF5E,
	0x0050DF82,0x0050DFA6,0x0050DFCA,0x0050DFEB,0x0050E00C,0x0050E02D,0x0050EEFD,0x0050EF24,0x0050EF4B,0x0050EF72,
	0x0050EF99,0x0050EFC0,0x0050EFE4,0x0050F008,0x0050F02C,0x0050F06A,0x0050F0A8,0x0050F155,0x0050F17C,0x0050F1A3,
	0x0050F1CA,0x0050F1F1,0x0050F218,0x0050F23C,0x0050F260,0x0050F284,0x0050F2CD,0x0050F313,0x0051051E,0x00511EDC,
	0x0051250D,0x00514E1F,0x005155AA,0x005155EA,0x00515A2A,0x00515B17,0x00515B5E,0x00515FF2,0x005164EB,0x00517141,
	0x00517309,0x0051734B,0x0051758B,0x005176FF,0x005180E4,0x00518391,0x005187B6,0x005188EF,0x00518BB2,0x005190EF,
	0x00519130,0x00519171,0x005191AD,0x00519228,0x005193A4,0x00519617,0x005196CB,0x0051970D,0x0051A0F9,0x0051A157,
	0x0051A1C8,0x0051BF93,0x0051BFD3,0x0051D2D1,0x00520704,0x00520957,0x005217CB,0x0052247B,0x005233B3,0x00523471,
	0x005263D2,0x005264D8,0x00526532,0x005288C9,0x0052958C,0x00529709,0x0053348E,0x00533766,0x005381E6,0x00538D7E,
	0x00538F92,0x00539090,0x00539258,0x0053AF8E,0x0053B830,0x0053BE5E,0x0053C131,0x0053CABD,0x0053CAF4,0x0053CB5B,
	0x0053CB90,0x0053CBB9,0x0053CC12,0x0053CC88,0x0053CCAC,0x0053CD21,0x0053CD76,0x0053D2EE,0x0053D317,0x0053D357,
	0x0053D387,0x00542AD2,0x00542B15,0x00544529,0x00545DE2,0x0054678C,0x0054720D,0x00549B53,0x00549BCF,0x00549C72,
	0x0054AC7E,0x0054AC9E,0x0054ACBE,0x0054ACDE,0x0054AD1E,0x0054AD90,0x0054B138,0x0054B1C4,0x0054B1ED,0x0054BB1A,
	0x0054D7D5,0x0054D97A,0x0054DE1C,0x005517B8,0x0055404F,0x0055415F,0x00556844,0x0055723C,0x00557255,0x00558DD9,
	0x00558E00,0x0055AB94,0x0055AEA2,0x0055AF36,0x0055AF50,0x0055B752,0x0055B78A,0x0055C20B,0x0055C752,0x0055C9AB,
	0x0055CDD3,0x0055D1FB,0x0055DC36,0x0055DD0A,0x0055E858,0x0055F89F,0x0056056E,0x00561B95,0x00562EBC,0x00563F07,
	0x00563F35,0x00563F66,0x00563F91,0x00563FBF,0x005640A1,0x005640DE,0x0056412D,0x005641A9,0x00564690,0x005646C5,
	0x00564781,0x005647BB,0x005647F2,0x00564829,0x00564860,0x0056489A,0x005648D1,0x00564908,0x00564942,0x00564979,
	0x005649B2,0x005649E9,0x00565038,0x0056513F,0x00565176,0x00565252,0x00565310,0x005653D0,0x005654BF,0x005656E0,
	0x0056574B,0x00565A0B,0x00565C0D,0x00565DC4,0x00565E52,0x005660A6,0x005660D2,0x005660FE,0x0056612A,0x00566156,
	0x00566182,0x005661AE,0x005661DA,0x00566206,0x00566232,0x0056625E,0x0056628A,0x005662B6,0x005662E2,0x0056630E,
	0x00566383,0x005663AB,0x005663FC,0x00566509,0x005665AE,0x005665E5,0x0056B2AD,0x0056B2EE,0x0056B30B,0x0056B328,
	0x0056B345,0x0056B362,0x0056B77D,0x0056BBA6,0x00576260,0x00576288,0x0057631B,0x005773D7,0x00577690,0x005776A4,
	0x0057969C,0x0057973F,0x005797AF,0x0057A438,0x0057A497,0x0057A959,0x0057A974,0x0057AAE9,0x0057CD95,0x0057DB65,
	0x0057DD8C,0x0057DEBF,0x0057DF24,0x0057E13E,0x0057E63F,0x0057E94A,0x0057E9BE,0x0057F813,0x0057F9CA,0x00580992,
	0x00581266,0x0058266E,0x00582759,0x00586D09,0x00586E3E,0x00586FA9,0x00587102,0x00587160,0x005871BB,0x00587331,
	0x00587365,0x005873A0,0x005873D8,0x00587729,0x00587840,0x005878A8,0x0058797A,0x00587B03,0x00587CC4,0x00587E22,
	0x00588153,0x00588596,0x0058899C,0x00588F14,0x00589173,0x00589262,0x0058983A,0x005899CE,0x0058A033,0x0058A2EE,
	0x0058A8F5,0x0058A996,0x0058B46E,0x0058B47D,0x0058B81E,0x0058B82D,0x0058BC23,0x0058BC32,0x0058BCE7,0x0058BCF6,
	0x0058C47C,0x00594FBB,0x00595F65,0x00596991,0x0059806D,0x0059838F,0x0059840B,0x005984A5,0x00598521,0x005985BB,
	0x00598637,0x005987D1,0x005987F4,0x00598817,0x00599319,0x005995CA,0x0059CCC3,0x0059F567,0x005A27FA,0x005A2819,
	0x005A2ADA,0x005A32E5,0x005A3315,0x005A3379,0x005A3391,0x005A33ED,0x005A342B,0x005A5573,0x005B31D9,0x005B9107,
	0x005BAFAC,0x005BBB1A,0x005BBD2C,0x005BCFC4,0x005BD08E,0x005BD56E,0x005BD8B6,0x005BE48C,0x005BE8EF,0x005BE959,
	0x005BEE63,0x005C8FAD,0x005CA632,0x005CA682,0x005CDC08,0x005CDC7D,0x005CDF08,0x005CDF7E,0x005CE0A4,0x005CE0FC,
	0x005CE18C,0x005D1ACF,0x005D4356,0x005D452C,0x005D4734,0x005D8910,0x005D9DF0,0x005DDF84,0x005DF0FE,0x005DF9EB,
	0x005DFC5A,0x005E2F04,0x005E3816,0x005EDAD4,0x005F7089,0x00601B80,0x0060406C,0x00604BC7,0x00604BF0,0x00604C19,
	0x00604C6E,0x00604D22,0x006057CA,0x00606E1B,0x00606E34,0x00606E4D,0x00607133,0x006072AC,0x00607D4D,0x006086B6,
	0x00608F1B,0x00608F34,0x00608F4D,0x006092AC,0x006094B3,0x0060988C,0x0060B016,0x0060B0FA,0x0060B1DC,0x0060B2B0,
	0x0060B2D7,0x0060B326,0x0060BDC3,0x00619E03,0x00630FE6,0x00633410,0x00634196,0x006341C7,0x006341F9,0x006348FB,
	0x0063492E,0x006349F3,0x00634A26,0x00634E10,0x00634E6F,0x00634ECE,0x00634F2E,0x00634F5A,0x00635860,0x00635A13,
	0x00635BC6,0x00635E6F,0x00635F68,0x00635FE9,0x006360B0,0x006360D4,0x006360F4,0x00636115,0x00636136,0x0063616A,
	0x0063619D,0x006361D6,0x0063620F,0x00636247,0x00636280,0x006362B9,0x006362F1,0x0063637E,0x006363B2,0x006363E5,
	0x00636419,0x00636467,0x0063649B,0x006364FB,0x00636605,0x00636764,0x006367EF,0x0063694E,0x006369DC,0x00636ACA,
	0x00636BBE,0x00636BF2,0x00636C26,0x00636CE9,0x00636D0A,0x00636D2B,0x00636D4B,0x00636D6C,0x00636D8D,0x00636DAA,
	0x00636DC8,0x00636DE6,0x00636E03,0x0063724B,0x006384FF,0x00638528,0x00638551,0x00638634,0x00638734,0x00638786,
	0x00638974,0x006389C4,0x006389F2,0x00638A75,0x00638ABC,0x00638C26,0x00638C7D,0x00638CC3,0x00640A38,0x00640B26,
	0x00641CF0,0x00641DDE,0x0064201E,0x006420AB,0x006420C6,0x00642116,0x0064226D,0x0064256D,0x00642894,0x00642BCE,
	0x00642BF1,0x00642EB3,0x006431D0,0x0064338E,0x0064393E,0x006439F4,0x00643A05,0x00643FC6,0x006444BA,0x0064458A,
	0x00646CAB,0x0064A85F,0x0064CC55,0x0064F396,0x00652260,0x006525A0,0x0065C0B3,0x0065C806,0x0065C890,0x0065C91A,
	0x0065C957,0x0065CA16,0x0065CB5E,0x0065CFD9,0x0065D82D,0x0065DA7B,0x0065DB94,0x0065EC93,0x0065EEC6,0x00661575,
	0x0066339A,0x00666352,0x00666365,0x00666378,0x0069AB89,0x0069AC65,0x0069CEDB,0x0069EB81,0x0069F416,0x0069F484,
	0x0069FAA4,0x0069FACC,0x006C6897,0x006C6FDE,0x006DE5C6,0x00721552,0x0052D13C,0x0052D22A,0x0052D49E,0x0052D61F,
	0x0052D651,0x0052D69F,0x0052D6D1,0x0052D86A,0x00531920,0x00531941,0x00531962,0x00531983,0x005319A1,0x005319BF,
	0x005319DD,0x005319FB,0x00531A3F,0x00531A60,0x00531A81,0x00531AA2,0x00531AC0,0x00531ADE,0x00531AFC,0x00531B1A,
	0x00531B5E,0x00531B7F,0x00531BA0,0x00531BC1,0x00531BDF,0x00531BFD,0x00531C1B,0x00531C39,0x00531C7D,0x00531C9E,
	0x00531CBF,0x00531CE0,0x00531CFE,0x00531D1C,0x00531D3A,0x00531D58,0x00531D9C,0x00531DBD,0x00531DDE,0x00531DFF,
	0x00531E1D,0x00531E3B,0x00531E59,0x00531E77,0x00531EBB,0x00531EDC,0x00531EFA,0x00531F18,0x00531F36,0x00531F54,
	0x00531F8B,0x00531FC2,0x0053FE02,0x0056586C,0x005658B4,0x00587214,0x00587434,0x005A6CB8,0x005AB372,0x005AB427,
	0x005AB7A2,0x0063343D,0x0063346A,0x00633497,0x006334C4,0x006334F1,0x0063351E,0x0063354B,0x00633578,0x006335A5,
	0x006335D2,0x006335FF,0x0063362C,0x00633659,0x00633686,0x006336B3,0x006336E0,0x0063370D,0x0063373A,0x00633767,
	0x00633794,0x006337C1,0x00634C9F,0x00634D44,0x00634D75,0x00647180,0x0064978B,0x00649ED3,0x00649F58,0x0069AC94,
	0x0069ACC1,0x0069ACEE,0x0069AD19,0x0069AD46,0x0069AD73
};

void IOnSend::Hook()
{
	Interface<ITools> Tools;

	for(size_t i=0; i < sizeof this->Patches / sizeof(unsigned long); i++)
		Tools->Intercept(ITools::_I_CALL, (void*)IOnSend::Patches[i], Hooks::KSocket::WritePacketAutoCrc, 5);
}